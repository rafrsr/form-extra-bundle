{% if form.vars.choices is defined and select2_options is defined %}
    <script>
        $(function () {
            var options = {
                templateResult: function (result) {
                    if (result.element && $(result.element).data('template-result') && $(result.element).data('template-result') != undefined) {
                        return $(result.element).data('template-result');
                    }

                    return result.text;
                },
                templateSelection: function (result) {
                    if (result.element && $(result.element).data('template-selection') && $(result.element).data('template-selection') != undefined) {
                        return $(result.element).data('template-selection');
                    }

                    return result.text;
                },
                escapeMarkup: function (markup) {
                    return markup;
                }
            };
            options = $.extend(options,{{ select2_options|raw }});
            $('#{{ form.vars.id }}').select2(options);
        });
    </script>
{% endif %}
